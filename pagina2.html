<!DOCTYPE html>
<html lang="pt-BR"> 
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nossa Galeria - Bibia & Gabriel</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Parisienne&family=Poppins:wght@300;400;700&display=swap" rel="stylesheet">
    
    <script src="https://cdn.tailwindcss.com"></script> 
    <link rel="stylesheet" href="estilo.css"> 
</head>
<body>
    <!-- Cabe√ßalho Simplificado para a p√°gina da galeria -->
    <header class="header" style="margin-bottom: 20px;">
        <h1 data-lang="galleryPageTitle" style="font-size: 2.8em;">Nossa Galeria de Mem√≥rias</h1>
    </header>

    <main class="gallery-page-container">
        <h2 data-lang="galleryComingSoon">Momentos Juntos... üì∏‚ù§Ô∏è</h2>
        
        <!-- Galeria em Grade -->
        <div id="galleryGrid" class="gallery-grid">
            <!-- As imagens que existem ser√£o inseridas aqui pelo JavaScript -->
        </div>
        <!-- Fim da Galeria em Grade -->

        <div class="back-link-container">
            <a href="index.html" class="back-link" data-lang="backToMain">Voltar para a Surpresa Principal</a> 
        </div>
    </main>

    <footer class="footer" style="margin-top: 50px;">
        <p data-lang="footerMadeWithLove">Feito com <span class="heart">‚ù§</span> especialmente para Bibia!</p>
    </footer>

    <!-- Estrutura do Lightbox -->
    <div id="lightboxOverlay" class="lightbox-overlay">
        <span id="closeLightbox" class="lightbox-button lightbox-close">&times;</span>
        <span id="prevImage" class="lightbox-button lightbox-prev">&#10094;</span>
        <div class="lightbox-content">
            <img id="lightboxImage" src="" alt="Imagem em tamanho grande">
        </div>
        <span id="nextImage" class="lightbox-button lightbox-next">&#10095;</span>
    </div>

    <script>
        // --- Internacionaliza√ß√£o (simplificada para esta p√°gina) ---
        const langStringsGallery = {
            pt: {
                galleryPageTitle: "Nossa Galeria de Mem√≥rias",
                galleryComingSoon: "Momentos Juntos... üì∏‚ù§Ô∏è",
                backToMain: "Voltar para a Surpresa Principal",
                footerMadeWithLove: "Feito com <span class=\"heart\">‚ù§</span> especialmente para Bibia!"
            },
            es: {
                galleryPageTitle: "Nuestra Galer√≠a de Recuerdos",
                galleryComingSoon: "Nuestros Momentos Juntos... üì∏‚ù§Ô∏è",
                backToMain: "Volver a la Sorpresa Principal",
                footerMadeWithLove: "¬°Hecho con <span class=\"heart\">‚ù§</span> especialmente para Bibia!"
            }
        };

        function setPageLanguage(lang) {
            document.documentElement.lang = lang.toUpperCase();
            const elements = document.querySelectorAll('[data-lang]');
            elements.forEach(el => {
                const key = el.dataset.lang;
                if (langStringsGallery[lang] && langStringsGallery[lang][key]) {
                    el.innerHTML = langStringsGallery[lang][key];
                }
            });
        }
        const savedLang = localStorage.getItem('minisiteLanguage');
        const initialLang = savedLang || 'pt';
        setPageLanguage(initialLang);

        // --- L√≥gica da Galeria em Grade e Lightbox ---
        document.addEventListener('DOMContentLoaded', () => {
            const galleryGrid = document.getElementById('galleryGrid');
            const lightboxOverlay = document.getElementById('lightboxOverlay');
            const lightboxImage = document.getElementById('lightboxImage');
            const closeLightboxBtn = document.getElementById('closeLightbox');
            const prevImageBtn = document.getElementById('prevImage');
            const nextImageBtn = document.getElementById('nextImage');

            const totalImages = 21;
            let validImages = []; // Array que conter√° apenas as imagens que existem
            let currentLightboxIndex = 0;

            // Fun√ß√£o para popular a grade com as imagens que carregaram
            const populateGrid = (imagePaths) => {
                galleryGrid.innerHTML = ''; // Limpa a grade
                imagePaths.forEach((path, index) => {
                    const item = document.createElement('div');
                    item.className = 'photo-item';
                    
                    const img = document.createElement('img');
                    img.src = path;
                    img.alt = `Momento ${index + 1}`;
                    img.loading = 'lazy';
                    
                    item.appendChild(img);
                    item.onclick = () => openLightbox(index);
                    galleryGrid.appendChild(item);
                });
            };

            // Tenta carregar todas as imagens
            let imagePromises = [];
            for (let i = 1; i <= totalImages; i++) {
                const imagePath = `img/img${i}.jpg`;
                const promise = new Promise((resolve, reject) => {
                    const img = new Image();
                    img.src = imagePath;
                    img.onload = () => resolve(imagePath);
                    img.onerror = () => reject(imagePath);
                });
                imagePromises.push(promise);
            }

            Promise.allSettled(imagePromises).then(results => {
                validImages = results
                    .filter(result => result.status === 'fulfilled')
                    .map(result => result.value);
                
                if (validImages.length > 0) {
                    populateGrid(validImages);
                } else {
                    galleryGrid.innerHTML = `<p style="color: #c2185b; text-align: center; font-size: 1.2em;">Nenhuma foto encontrada na galeria ainda...</p>`;
                }
            });
            
            // Fun√ß√µes do Lightbox
            function openLightbox(index) {
                if (index < 0 || index >= validImages.length) return;
                currentLightboxIndex = index;
                updateLightboxImage();
                lightboxOverlay.style.display = 'flex';
            }

            function closeLightbox() {
                lightboxOverlay.style.display = 'none';
            }

            function changeImage(direction) {
                if(validImages.length === 0) return;
                currentLightboxIndex = (currentLightboxIndex + direction + validImages.length) % validImages.length;
                updateLightboxImage();
            }

            function updateLightboxImage() {
                if(validImages.length > 0){
                    lightboxImage.src = validImages[currentLightboxIndex];
                }
            }

            // Event Listeners do Lightbox
            closeLightboxBtn.addEventListener('click', closeLightbox);
            prevImageBtn.addEventListener('click', () => changeImage(-1));
            nextImageBtn.addEventListener('click', () => changeImage(1));
            lightboxOverlay.addEventListener('click', (e) => {
                if (e.target === lightboxOverlay) { closeLightbox(); }
            });
            document.addEventListener('keydown', (e) => {
                if (lightboxOverlay.style.display !== 'none') {
                    if (e.key === 'Escape') { closeLightbox(); } 
                    else if (e.key === 'ArrowLeft') { changeImage(-1); } 
                    else if (e.key === 'ArrowRight') { changeImage(1); }
                }
            });
        });

    </script>
</body>
</html>